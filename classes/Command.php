<?php

class Command
{
//======================================================================================================================

    private $c;

//======================================================================================================================

    public function __construct($dbh, $command)
    {
        $this->c = $dbh->prepare($command);
        return $this;
    }

//======================================================================================================================

    function getHandler()
    {
        return $this->c;
    }

//======================================================================================================================

    function bindValue ($key, $v)
    {
        $this->c->bindValue($key,$v);
        return $this;
    }

//======================================================================================================================

    function bindParam ($key, $p)
    {
        $this->c->bindParam($key,$p);
        return $this;
    }

//======================================================================================================================

    function execute ()
    {
        try {

            $this->c->execute();
            return $this;

        } catch (Exception $e) {
            Box::error($e->getMessage());
        }
    }

//======================================================================================================================

    function queryRow()
    {
        $this->execute();
        return $this->c->fetch(PDO::FETCH_ASSOC);
    }

//======================================================================================================================

    function queryColumn()
    {
        $this->execute();
        return $this->c->fetchAll(PDO::FETCH_COLUMN);
    }

//======================================================================================================================

    function queryAll()
    {
        $this->execute();
        return $this->c->fetchAll(PDO::FETCH_ASSOC);
    }

//======================================================================================================================

    function queryScalar()
    {
        $this->execute();
        $result = $this->c->fetch(PDO::FETCH_BOTH);
        return $result[0];
    }

//======================================================================================================================

}

?>